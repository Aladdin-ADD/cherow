import { Token, descKeywordTable } from '../token';
import { State } from '../types';
import { nextChar } from './common';

export const enum CharType {
  IDStart,
  Zero,
  Number,
  Invalid,
  LineTerminator,
  Exclamation,
  LeftParen,
  RightParen,
  LeftBracket,
  RightBracket,
  Comma,
  Colon,
  QuestionMark,
  Tilde,
  Quote,
  BackQuote,
  Period,
  Slash,
  BackSlash,
  Semicolon,
  LeftBrace,
  RightBrace,
  Add,
  Sub,
  Multiply,
  Modulo,
  And,
  Xor,
  Or,
  Less,
  Greater,
  Equal,
  WhiteSpace,
  PrivateName
}

const LatinLetters = [
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.WhiteSpace,
  CharType.LineTerminator,
  CharType.WhiteSpace,
  CharType.WhiteSpace,
  CharType.LineTerminator,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.WhiteSpace,
  CharType.Exclamation,
  CharType.Quote,
  CharType.Invalid,
  CharType.IDStart,
  CharType.Modulo,
  CharType.And,
  CharType.Quote,
  CharType.LeftParen,
  CharType.RightParen,
  CharType.Multiply,
  CharType.Add,
  CharType.Comma,
  CharType.Sub,
  CharType.Period,
  CharType.Slash,
  CharType.Zero,
  CharType.Number,
  CharType.Number,
  CharType.Number,
  CharType.Number,
  CharType.Number,
  CharType.Number,
  CharType.Number,
  CharType.Number,
  CharType.Number,
  CharType.Colon,
  CharType.Semicolon,
  CharType.Less,
  CharType.Equal,
  CharType.Greater,
  CharType.QuestionMark,
  CharType.PrivateName,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.LeftBracket,
  CharType.BackSlash,
  CharType.RightBracket,
  CharType.Xor,
  CharType.IDStart,
  CharType.BackQuote,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.LeftBrace,
  CharType.Or,
  CharType.RightBrace,
  CharType.Tilde,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.WhiteSpace,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.IDStart,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.IDStart,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.IDStart,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.Invalid,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.Invalid,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.Invalid,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart,
  CharType.IDStart
];

export function scanIdentifier(state: State): Token {
  while (LatinLetters[nextChar(state)] <= CharType.Number) {}
  state.tokenValue = state.source.slice(state.startIndex, state.index);
  return descKeywordTable[state.tokenValue] || Token.Identifier;
}
