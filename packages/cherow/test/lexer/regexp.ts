import * as t from 'assert';
import { scanRegExp, RegExpState } from '../../src/lexer/regexp';
import { createParserObject } from '../../src/parser/parser';
import { Context } from '../../src/common';
import { Token, tokenDesc } from '../../src/token';

/** 
 * Note! This is still WIP
 * 
 * Errors are returned as an number value to avoid the validator to throw
 * while inside "editor mode"
 * 
 */
describe('Lexer - Regeular expressions', () => {

    const regExs: Array < [string, RegExpState] > = [

        ['B/', RegExpState.Valid],
        ['(?=/', RegExpState.Invalid],
        ['B/', RegExpState.Valid],
        ['a*b/', RegExpState.Valid],
        ['a*', RegExpState.Invalid],
        ['a?', RegExpState.Invalid],
        ['a+', RegExpState.Invalid],
        ['??/', RegExpState.Invalid],
        ['??/', RegExpState.Invalid],
        ['+?/', RegExpState.Invalid],
        ['|*/', RegExpState.Invalid],
        ['|?/', RegExpState.Invalid],
        ['|+/', RegExpState.Invalid],
        ['?a/', RegExpState.Invalid],
        ['+/', RegExpState.Invalid],
        ['?/', RegExpState.Invalid],
        ['*/', RegExpState.Invalid],
        ['*a/', RegExpState.Invalid],
        ['*a', RegExpState.Invalid],
        ['?', RegExpState.Invalid],
        ['+', RegExpState.Invalid],
        ['?a', RegExpState.Invalid],
        ['a**/', RegExpState.Invalid],
        ['a?+/', RegExpState.Invalid],
        ['a++/', RegExpState.Invalid],
        ['?/', RegExpState.Invalid],
        ['*/', RegExpState.Invalid],
        ['a{1,0}/', RegExpState.NothingToRepeat],
        ['a{2,1}/', RegExpState.NothingToRepeat],
        ['a{100,45}/', RegExpState.NothingToRepeat],
        ['a{1 ,1}/', RegExpState.InvalidQuantifier],
        ['a{ 1 , 1}/', RegExpState.InvalidQuantifier],
        ['a{1,1 }/', RegExpState.InvalidQuantifier],
        ['a{1, 1 }/', RegExpState.InvalidQuantifier],
        ['a{01,1}/', RegExpState.NothingToRepeat],
        ['a{0x01,1}/', RegExpState.InvalidQuantifier],
        ['a{0x15,02}/', RegExpState.InvalidQuantifier],
        ['a{0b01,04}/', RegExpState.InvalidQuantifier],
        ['\\2(a)(/u', RegExpState.Invalid],
        ['\\2(a)(/', RegExpState.Invalid],
        ['(?:a)\\1/u', RegExpState.Invalid],
        ['(a)\\2/u', RegExpState.Invalid],
        ['(?:a)\\2/u', RegExpState.Invalid],
        ['(?:a)\\1/u', RegExpState.Invalid],
        ['(a)(a)(a)(a)(a)(a)(a)(a)(a)(a)(a)\\11/u', RegExpState.Valid],
        ['(?/', RegExpState.Invalid],
        ['(?/u', RegExpState.Invalid],
        ['(?a/u', RegExpState.Invalid],
        ['(?a)/u', RegExpState.Invalid],
        ['(?:/', RegExpState.Invalid],
        ['(?:a/', RegExpState.Invalid],
        ['(?:a/', RegExpState.Invalid],
        ['\\u{z/u', RegExpState.Invalid],
        ['\\u{20/u', RegExpState.Invalid],
        ['\\u{110000}/u', RegExpState.InvalidQuantifier],
        ['\\377/u', RegExpState.Invalid],
        ['\\400/u', RegExpState.Invalid],
        ['\\a/u', RegExpState.Invalid],
        ['[b-a]/', RegExpState.Invalid],
        ['[b-a]/u', RegExpState.Invalid],
        ['[a-b--+]/', RegExpState.Invalid],
        ['[a-b--+]/u', RegExpState.Invalid],
        ['[\\c1]/u', RegExpState.Invalid],
        ['[\\x]/u', RegExpState.Invalid],
        ['[\\xz]/u', RegExpState.Invalid],
        ['[\\x1]/u', RegExpState.Invalid],
        ['[\\u]/u', RegExpState.Invalid],
        ['[\\u1]/u', RegExpState.Invalid],
        ['[\\u12]/u', RegExpState.Invalid],
        ['[\\u123]/u', RegExpState.Invalid],
        ['[\\u1234]/u', RegExpState.ValidAsUnicode],
        ['[\\u{]/u', RegExpState.Invalid],
        ['[\\u{z]/u', RegExpState.Invalid],
        ['[\\u{20]/u', RegExpState.Invalid],
        ['[\\u{110000}]/u', RegExpState.ValidAsUnicode],
        ['[\\77]/u', RegExpState.Invalid],
        ['[\\377]/u', RegExpState.Invalid],
        ['[\\$]/u', RegExpState.ValidAsUnicode],
        ['[\\a]/u', RegExpState.Invalid],
        ['[\\d-\\uFFFF]/u', RegExpState.ValidAsUnicode],
        ['[\\D-\\uFFFF]/u', RegExpState.ValidAsUnicode],
        ['[\\s-\\uFFFF]/u', RegExpState.ValidAsUnicode],
        ['[\\S-\\uFFFF]/u', RegExpState.ValidAsUnicode],
        ['[\\w-\\uFFFF]/u', RegExpState.ValidAsUnicode],
        ['[\\W-\\uFFFF]/u', RegExpState.ValidAsUnicode],
        ['[\\u0000-\\d]/u', RegExpState.ValidAsUnicode],
        ['[\\u0000-\\D]/u', RegExpState.ValidAsUnicode],
        ['[\\u0000-\\s]/u', RegExpState.ValidAsUnicode],
        ['[\\u0000-\\S]/u', RegExpState.ValidAsUnicode],
        ['[\\u0000-\\w]/u', RegExpState.ValidAsUnicode],
        ['[\\u0000-\\W]/u', RegExpState.ValidAsUnicode],
        ['[\\u0001-\\u0000]/', RegExpState.Invalid],
        ['[\\u0001-\\u0000]/u', RegExpState.Invalid],
        ['[\\u{1}-\\u{2}]/', RegExpState.ValidAsUnicode],
        ['[\\u{2}-\\u{1}]/', RegExpState.ValidAsUnicode],
        ['[\\u{2-\\u{1}]/u', RegExpState.Invalid],
        ['[\\a-\\z]/u', RegExpState.Invalid],
        ['[\\z-\\a]/', RegExpState.Invalid],
        ['[\\z-\\a]/u', RegExpState.Invalid],
        ['[0-9--+]/', RegExpState.Invalid],
        ['[0-9--+]/u', RegExpState.Invalid],
        ['[\\c-a]/', RegExpState.Invalid],
        ['[\\c0-]/u', RegExpState.Invalid],
        ['[üå∑-üå∏]/u', RegExpState.ValidAsUnicode],
        ['[\\uD834\\uDF06-\\uD834\\uDF08a-z]/', RegExpState.ValidAsUnicode],
        ['[\\d][\\12-\\14]{1,}[^\\d]/u', RegExpState.Invalid],
        ['[üå∑-üå∏]/u', RegExpState.ValidAsUnicode],
        ['[üå∏-üå∑]/', RegExpState.Invalid],
        ['[üå∏-üå∑]/u', RegExpState.Invalid],
        ['^[^\\x20-\\x7e]*$/', RegExpState.ValidAsUnicode],
        ['^[„Ç°-„É≥„É¥„Éº]*$/', RegExpState.Valid],
        ['a*/', RegExpState.Valid],
        ['a*b/', RegExpState.Valid],
        ['a?b/', RegExpState.Valid],
        ['a+b/', RegExpState.Valid],
        ['a??/', RegExpState.Valid],
        ['a{0}/', RegExpState.Valid],
        ['a{11}/', RegExpState.Valid],
        ['a{0,0}/', RegExpState.Valid],
        ['a{1,16}/', RegExpState.Valid],
        ['a{23,37}/', RegExpState.Valid],
        ['a{34,48}/', RegExpState.Valid],
        ['a{56,60}/', RegExpState.Valid],
        ['a{67,71}/', RegExpState.Valid],
        ['a{89,93}/', RegExpState.Valid],
        ['a{,50}/', RegExpState.Valid],
        ['^[„ÅÅ-„Çì„Éº]*$/', RegExpState.Valid],
        ['^([1-9][0-9]*|0)(\\.[0-9]+)?$/', RegExpState.Valid],
        ['^\\d{1,3}(.\\d{1,3}){3}$/', RegExpState.Valid],
        ['^\\d{3}-\\d{4}$/', RegExpState.Valid],
        ['^https?:\\/\\//', RegExpState.Valid],
        ['^([0-9]{0,8})$/u', RegExpState.Valid],
        ['^([a-zA-Z0-9]{6,8})$/u', RegExpState.Valid],
        ['/^([0-9]{0,8})$/', RegExpState.Valid],
        ['^([a-zA-Z0-9]{6,8})$/', RegExpState.Valid],
        ['^[a-zA-Z0-9!-/:-@\\[-`{-~]*$/u', RegExpState.ValidAsUnicode],
        ['^[a-zA-Z0-9!-/:-@\\[-`{-~]*$/', RegExpState.ValidAsUnicode],
        ['^[a-zA-Z]+$/', RegExpState.Valid],
        ['^[0-9]+$/u', RegExpState.Valid],
        ['^[a-zA-Z]*$/', RegExpState.Valid],
        ['^[a-zA-Z]*$/', RegExpState.Valid],
        ['^[0-9]+$/', RegExpState.Valid],
        ['^[0-9]*$/', RegExpState.Valid],
        ['[üå∑-üå∏]/u', RegExpState.ValidAsUnicode],
        ['[\\c_]/', RegExpState.Invalid],
        ['[\\c0-]/', RegExpState.Invalid],
        ['[0-9--/]/', RegExpState.Invalid],
        ['[\\u0000-\\s]/', RegExpState.ValidAsUnicode],
        ['[\\w-\\uFFFF]/', RegExpState.ValidAsUnicode],
        ['[\\d-\\uFFFF]/', RegExpState.ValidAsUnicode],
        ['[\\|]/', RegExpState.ValidAsUnicode],
        ['[\\]]/', RegExpState.ValidAsUnicode],
        ['[\\(]/u', RegExpState.Valid],
        ['[\\(]/', RegExpState.Valid],
        ['[\\?]/', RegExpState.ValidAsUnicode],
        ['[\\$]/u', RegExpState.ValidAsUnicode],
        ['[\\$]/', RegExpState.ValidAsUnicode],
        ['[\\^]/', RegExpState.ValidAsUnicode],
        ['[\\377]/', RegExpState.Invalid],
        ['[\\u{00000001}]/', RegExpState.ValidAsUnicode],
        ['[\\u{a}]/', RegExpState.ValidAsUnicode],
        ['[\\u1234]/', RegExpState.ValidAsUnicode],
        ['[\\x123]/u', RegExpState.ValidAsUnicode],
        ['[\\x12]/u', RegExpState.ValidAsUnicode],
        ['[\\v]/', RegExpState.ValidAsUnicode],
        ['[\\r]/u', RegExpState.ValidAsUnicode],
        ['[\\f]/u', RegExpState.ValidAsUnicode],
        ['[\\S]/', RegExpState.ValidAsUnicode],
        ['[\\s]/', RegExpState.ValidAsUnicode],
        ['[b\\-a]/u', RegExpState.ValidAsUnicode],
        ['[a-b--/]/', RegExpState.Invalid],
        ['[a-]/', RegExpState.Valid],
        ['[-a-]/u', RegExpState.Valid],
        ['[--]/', RegExpState.Valid],
        ['[a]/', RegExpState.Valid],
        ['[-]/', RegExpState.Valid],
        ['[^-a-b-]/u', RegExpState.Valid],
        ['\\s/', RegExpState.Valid],
        ['[]/', RegExpState.Valid],
        ['\\a/', RegExpState.Invalid],
        ['\\p/', RegExpState.Invalid],
        ['\\q/', RegExpState.Invalid],
        ['\\Q/', RegExpState.Invalid],
        ['\\qabcd/', RegExpState.Invalid],
        ['\\Nabcd/', RegExpState.Invalid],
        ['\\a/', RegExpState.Invalid],
        ['\\//', RegExpState.Valid],
        ['\\{/', RegExpState.Valid],
        ['\\]/', RegExpState.Valid],
        ['\\[/u', RegExpState.Valid],
        ['\\[/', RegExpState.Valid],
        ['\\)/u', RegExpState.Valid],
        ['\\)/', RegExpState.Valid],
        ['\\(/u', RegExpState.Valid],
        ['\\(/', RegExpState.Valid],
        ['\\?/u', RegExpState.Valid],
        ['\\?/', RegExpState.Valid],
        ['\\+/u', RegExpState.Valid],
        ['\\./u', RegExpState.Valid],
        ['\\./', RegExpState.Valid],
        ['\\$/u', RegExpState.Valid],
        ['\\$/', RegExpState.Valid],
        ['\\u{20}/', RegExpState.ValidAsUnicode],
        ['\\u{a}/u', RegExpState.ValidAsUnicode],
        ['\\u12345/u', RegExpState.Valid],
        ['\\u12345/', RegExpState.Valid],
        ['\\t/u', RegExpState.Valid],
        ['\\v/', RegExpState.Valid],
        ['a{0}/', RegExpState.Valid],
        ['a{11}/', RegExpState.Valid],
        ['a{1}/', RegExpState.Valid],
        ['a{2}/', RegExpState.Valid],
        ['a{3}/', RegExpState.Valid],
        ['a{89}/', RegExpState.Valid],
        ['a{9,}/', RegExpState.Valid],
        ['a{78,}//', RegExpState.Valid],
        ['a{34,3}/', RegExpState.NothingToRepeat],
        ['a{3,38}/', RegExpState.Valid],
        ['\\f/', RegExpState.Valid],
        ['(?:a)/u', RegExpState.Valid],
        ['(?:a)/', RegExpState.Valid],
        ['(a)(a)(a)(a)(a)(a)(a)(a)(a)(a)(a)\\11/', RegExpState.Valid],
        ['(a)(a)(a)(a)(a)(a)(a)(a)(a)(a)\\10/', RegExpState.Valid],
        //['(?:a)\\2/', RegExpState.Valid],
        //        ['(a)\\2/', RegExpState.Valid],
        ['(?:a)\\1/', RegExpState.Invalid],
        ['(a)\\1/', RegExpState.Valid],
        ['a{2,27}/', RegExpState.Valid],

        ['|/', RegExpState.Valid],
        ['$/', RegExpState.Valid],
        ['./', RegExpState.Valid],
        ['[\\bc]/u', RegExpState.Valid],
        ['[a\\bb]/u', RegExpState.Valid],
        ['a{1,}?/', RegExpState.Valid],
        ['a{1}?/', RegExpState.Valid],
        //['a{a}?/', RegExpState.Valid],
        // ['a{}?/', RegExpState.Valid],
        ['a+?/', RegExpState.Valid],
        ['a*?/', RegExpState.Valid],
        //['a{1,2/', RegExpState.Valid],
        ['a{1,2}/', RegExpState.Valid],
        ['[^-J]/ug', RegExpState.Valid],
        ['[^-fdsasgJ]/g', RegExpState.Valid],
        ['[^J-]/ug', RegExpState.Valid],
        ['[^J-]/ug', RegExpState.Valid],
        ['[\\b]/u', RegExpState.Valid],
        ['[a\\bc]/u', RegExpState.Valid],
        ['[\\bc]/u', RegExpState.Valid],
        ['[a\\bb]/u', RegExpState.Valid],
        ['[a\\-b]/u', RegExpState.ValidAsUnicode],
        ['[\\-c]/u', RegExpState.ValidAsUnicode],
        ['[a\\-c]/u', RegExpState.ValidAsUnicode],
        ['[^---]/ug', RegExpState.Valid],
        ['a{,27}/', RegExpState.Valid],
        ['a{1,1}/', RegExpState.Valid],
        ['a{1,1}/', RegExpState.Valid],
        ['oo/i', RegExpState.Valid],
        ['\\D/', RegExpState.Valid],
        ['\\f/', RegExpState.Valid],
        ['\\s/', RegExpState.Valid],
        ['\\t/', RegExpState.Valid],
        ['\\v/', RegExpState.Valid],
        ['\\W/', RegExpState.Valid],
        ['abc\\Sdeff/', RegExpState.Valid],
        ['abc\\q/', RegExpState.Invalid],
        ['abc\\x/', RegExpState.Invalid],
        ['\\X/', RegExpState.Invalid],
        ['\\z/', RegExpState.Invalid],
        ['\\x/', RegExpState.Invalid],
        ['\\oabcd/', RegExpState.Invalid],
        ['\\Mabcd/', RegExpState.Invalid],
        ['abc\\odeff/', RegExpState.Invalid],
        ['abc\\qdeff/', RegExpState.Invalid],
        ['\\Jabcd/', RegExpState.Invalid],
        ['\\o/', RegExpState.Invalid],
        ['abc\\e/', RegExpState.Invalid],
        ['abc\\A/', RegExpState.Invalid],
        ['abc\\H/', RegExpState.Invalid],
        ['abc\\J/', RegExpState.Invalid],
        ['abc\\L/', RegExpState.Invalid],
        ['\\Iabcd/', RegExpState.Invalid],
        ['abc\\_abcd/', RegExpState.Invalid],
        ['\\iabcd/', RegExpState.Invalid],
        ['abc\\adeff/', RegExpState.Invalid],
        ['\\rabcd/', RegExpState.Valid],
        ['\\tabcd/', RegExpState.Valid],
        ['\\vabcd/', RegExpState.Valid],
        ['\\sabcd/', RegExpState.Valid],
        ['abc\\s/', RegExpState.Valid],
        ['abc\\S/', RegExpState.Valid],
        ['abc\\W/', RegExpState.Valid],
        ['abc\\d/', RegExpState.Valid],
        ['\\gabcd/', RegExpState.Invalid],
        ['abc\\gdeff/', RegExpState.Invalid],
        ['[\\ud900y]/', RegExpState.Valid],
        ['[\\ud900\\ud900y]/', RegExpState.Valid],
        ['\\$abcd/', RegExpState.Valid],
        ['abc\\$abcd/', RegExpState.Valid],
        ['abc\\ideff/', RegExpState.Invalid],
        ['a|(|)/', RegExpState.Valid],
        ['[1-9]/', RegExpState.Valid],
        ['(((((((((((((a)))))))))))))\\13/', RegExpState.Valid],
        ['?/u', RegExpState.Invalid],
        ['a{23,2}/u', RegExpState.NothingToRepeat],
        ['x\\u0567/', RegExpState.Valid],
        ['abc\\Ddeff/u', RegExpState.Valid],
        ['\\ud800\\ud800\\udc00/u', RegExpState.Valid],
        ['\\u1234\\ud800/', RegExpState.Valid],
        ['\\u1234\\udc00/', RegExpState.Valid],
        ['\\u1234\\u1234\\udc00/', RegExpState.Valid],
        ['[-----]/u', RegExpState.Valid],
        ['\\u1234\\udc00\\udc00/', RegExpState.Valid],
        ['\\ud800\\udc00\\udc00/', RegExpState.Valid],
        ['\\ud800\\udc00\\ud800/', RegExpState.Valid],
        ['[C]/', RegExpState.Valid],
        ['[c]/', RegExpState.Valid],
        ['[D]/', RegExpState.Valid],
        ['[d]/', RegExpState.Valid],
        ['[I]/', RegExpState.Valid],
        ['[o]/', RegExpState.Valid],
        ['[O]/', RegExpState.Valid],
        ['[i]/', RegExpState.Valid],
        ['[m]/', RegExpState.Valid],
        ['[M]/', RegExpState.Valid],
        ['[K]/', RegExpState.Valid],
        ['[k]/', RegExpState.Valid],
        ['[-b]/', RegExpState.Valid],
        ['a{1}/u', RegExpState.Valid],
        // ['a{1/', RegExpState.Valid],
        //['/a{}/', RegExpState.Valid],
        ['a?/u', RegExpState.Valid],
        ['a+/', RegExpState.Valid],
        ['(?=a){1,2}/', RegExpState.Valid],
        ['(?=a){1}/', RegExpState.Valid],
        //['(?=a){}/', RegExpState.Valid],
        // ['(?=a){/', RegExpState.Valid],
        ['(?!foo)/', RegExpState.Valid],
        ['(?!)/', RegExpState.Valid],
        ['(?=)/', RegExpState.Valid],
        ['||||/', RegExpState.Valid],
        ['foo|bar/', RegExpState.Valid],
        ['foo/', RegExpState.Valid],
        ['[a-]/', RegExpState.Valid],
        ['[\\b]/', RegExpState.Valid],
        ['[a\\bc]/', RegExpState.Valid],
        ['[\\bc]/', RegExpState.Valid],
        ['[a\\-b]/', RegExpState.ValidAsUnicode],
        ['[\\f]/', RegExpState.ValidAsUnicode],
        ['[\\n]/', RegExpState.ValidAsUnicode],
        ['[\\r]/', RegExpState.ValidAsUnicode],
        ['[\\f]/', RegExpState.ValidAsUnicode],
        ['[x\\ubcde\\udebcy]/y', RegExpState.ValidAsUnicode],
        ['[A-Z\\W]/', RegExpState.ValidAsUnicode],
        ['[A-\\Wx]/', RegExpState.Invalid],
        ['[1-9]/', RegExpState.Valid],
        ['[\\u5000-\\u6000]/', RegExpState.Valid],
        ['[\\uD83D\\uDCA9]/', RegExpState.ValidAsUnicode],
        ['[--0]/', RegExpState.Valid],
        ['[-+]/', RegExpState.Valid],
        ['[+-]/', RegExpState.Valid],
        ['[---+]/', RegExpState.Valid],
        ['[---0]/', RegExpState.Valid],
        ['[-]/', RegExpState.Valid],
        ['[--]/', RegExpState.Valid],
        ['[---]/', RegExpState.Valid],
        ['[----]/', RegExpState.Valid],
        ['[------]/', RegExpState.Valid],
        ['[---------]/', RegExpState.Valid],
        ['a(b)/', RegExpState.Valid],
        ['()/', RegExpState.Valid],
        ['(?:b)/', RegExpState.Valid],
        ['a(?:b)/', RegExpState.Valid],
        ['(?:b)c/', RegExpState.Valid],
        ['(?=b)/', RegExpState.Valid],
        ['(?!b)/', RegExpState.Valid],
        ['a(?!b)/', RegExpState.Valid],
        ['a(?!b)c/', RegExpState.Valid],
        ['a(?!b(?:c)d)e/', RegExpState.Valid],
        ['a(?!b(?=c)d)e/', RegExpState.Valid],
        ['a(?!b(?!c)d)e/', RegExpState.Valid],
        ['(?!.)*/', RegExpState.Valid],
        ['(?!.)?/', RegExpState.Valid],
        ['(?!.){1}/', RegExpState.Valid],
        ['a|ab/', RegExpState.Valid],
        ['((a)|(ab))((c)|(bc))/', RegExpState.Valid],
        ['\\d{3}|[a-z]{4}/', RegExpState.Valid],
        ['\\d{3}|[a-z]{4}/', RegExpState.Valid],
        ['ab|cd|ef/i', RegExpState.Valid],
        ['ab|cd|ef/', RegExpState.Valid],
        ['s$/', RegExpState.Valid],
        ['e$/', RegExpState.Valid],
        ['[^o]t\\b/i', RegExpState.Valid],
        ['\\d{2,4}/', RegExpState.Valid],
        ['^.*(:|$)/', RegExpState.Valid],
        ['^.*?/', RegExpState.Valid],
        ['^.*?$/', RegExpState.Valid],
        ['.?.?.?.?.?.?.?/', RegExpState.Valid],
        ['\\??\\??\\??\\??\\??/', RegExpState.Valid],
        ['ab?c?d?x?y?z/', RegExpState.Valid],
        ['[Jj]ava([Ss]cript)?(?=\\:)/', RegExpState.GoodSansUFlag],
        ['(.*?)a(?!(a+)b\\2c)\\2(.*)/', RegExpState.Valid],
        ['((((((((((A))))))))))\\1\\2\\3\\4\\5\\6\\7\\8\\9\\10/', RegExpState.Valid],
        ['[d-h]+/', RegExpState.Valid],
        ['[1234567].{2}/', RegExpState.Valid],
        ['[a-c\\d]+/', RegExpState.ValidAsUnicode],
        ['[^a-z]{4}/', RegExpState.Valid],
        ['/.[\\b]./', RegExpState.Valid],
        ['/c[\\b]{3}d/', RegExpState.Valid],
        ['\\Bo\\B/i', RegExpState.Valid],
        ['[f-z]e\\B/', RegExpState.Valid],
        ['\\Bevil\\B/', RegExpState.Valid],
        ['[1234567].{2}/', RegExpState.Valid],
        ['^^^^^^^robot$$$$/', RegExpState.Valid],
        ['[^a-z]{4}/', RegExpState.Valid],
        ['[d-h]+/', RegExpState.Valid],
        ['[1234567].{2}/', RegExpState.Valid],
        ['\\B\\w{4}\\B/', RegExpState.Valid],
        ['[^a-z]{4}/', RegExpState.Valid],
        ['[d-h]+/', RegExpState.Valid],
        ['[1234567].{2}/', RegExpState.Valid],
        ['\\B[^z]{4}\\B/', RegExpState.Valid],
        ['[^a-z]{4}/', RegExpState.Valid],
        ['[d-h]+/', RegExpState.Valid],
        ['[1234567].{2}/', RegExpState.Valid],
        ['\\B\\w/', RegExpState.Valid],
        ['[^a-z]{4}/', RegExpState.Valid],
        ['((((((((((A))))))))))\\10\\9\\8\\7\\6\\5\\4\\3\\2\\1/', RegExpState.Valid],
        ['[]a/', RegExpState.Valid],
        ['q[ax-zb](?=\\s+)/', RegExpState.Valid],
        ['[^a-z]{4}/', RegExpState.Valid],
        ['?1/mig', RegExpState.Invalid],
        ['c[\\b]{3}d/', RegExpState.Valid],
        ['[a-z]+/', RegExpState.Valid],
        ['\\b(\\w+) \\1\\b/', RegExpState.Valid],
        ['([xu]\\d{2}([A-H]{2})?)\\1/', RegExpState.Valid],
        ['([xu]\\d{2}([A-H]{2})?)\\1/', RegExpState.Valid],
        ['\\ //', RegExpState.GoodSansUFlag],
        ['\\:/', RegExpState.GoodSansUFlag],
        ['(?=)/', RegExpState.Valid],
        //['a{1,/', RegExpState.Valid],
        ['a*?/', RegExpState.Valid],
        ['a+?/', RegExpState.Valid],
        ['a+?/', RegExpState.Valid],
        ['a??/u', RegExpState.Valid],
        ['a{1,}?/', RegExpState.Valid],
        ['a{1,}?/u', RegExpState.Valid],
        // ['a{1,?/', RegExpState.Valid],
        ['a{1,2}?/', RegExpState.Valid],
        ['a{1,2}?/u', RegExpState.Valid],
        // ['a{1,2?/', RegExpState.Valid],
        ['üëçüöÄ‚ùáÔ∏è/', RegExpState.Valid],
        ['/üëçüöÄ‚ùáÔ∏è/u', RegExpState.Valid],
        ['$/u', RegExpState.Valid],
        ['./u', RegExpState.Valid],
        //[']/', RegExpState.Valid],
        // ['}/', RegExpState.Valid],
        ['${1,2/', RegExpState.NothingToRepeat],
        ['\\1(a)/', RegExpState.Valid],
        ['|a', RegExpState.Invalid],
        ['^', RegExpState.Invalid],
        ['^', RegExpState.Invalid],
        ['a*', RegExpState.Invalid],
        ['a*?', RegExpState.Invalid],
        ['?/', RegExpState.Invalid],
        ['+/', RegExpState.Invalid],
        ['?a/', RegExpState.Invalid],
        ['*/', RegExpState.Invalid],
        ['a**/', RegExpState.Invalid],
        ['+', RegExpState.Invalid],
        ['?a', RegExpState.Invalid],
        ['+a', RegExpState.Invalid],
        ['a++/', RegExpState.Invalid],
        ['a{100,45}/', RegExpState.NothingToRepeat],
        ['\\_abcd/', RegExpState.Invalid],
        ['\\_abcd/', RegExpState.Invalid],
        ['abc\\_/', RegExpState.Invalid],
        ['\\_/', RegExpState.Invalid],
        ['\\$', RegExpState.Invalid],
        ['\\\\', RegExpState.Invalid],
        ['{/', RegExpState.NothingToRepeat],
        //[']/', RegExpState.Valid],
        [')/', RegExpState.UnmatchedRightParen],
        ['+/', RegExpState.Invalid],
        ['a|*/', RegExpState.Invalid],
        ['a|+/', RegExpState.Invalid],
        ['a|?/', RegExpState.Invalid],
        ['a|)/', RegExpState.UnmatchedRightParen],
        //['a|]/', RegExpState.Valid],
        ['a|{/', RegExpState.NothingToRepeat],
        ['a|}/', RegExpState.InvalidQuantifier],
        ['a|(})/', RegExpState.Valid],
        ['a(?)/', RegExpState.Invalid],
        ['a|(])/', RegExpState.Valid],
        ['a(*)/', RegExpState.Invalid],
        ['a(+)/', RegExpState.Invalid],
        ['a|\\/', RegExpState.Invalid],
        ['\\$', RegExpState.Invalid],
        ['abc\\_', RegExpState.Invalid],
        ['\\0(b)', RegExpState.Invalid],
        ['(a)\\0', RegExpState.Invalid],
        ['\\u{00000000000000000000110000}/', RegExpState.InvalidQuantifier],
        ['\\u{0000000000000000000010ffff}/', RegExpState.ValidAsUnicode],
        ['[b\\-a]/', RegExpState.ValidAsUnicode],
        ['[a\\-b]/', RegExpState.ValidAsUnicode],
        ['[abc\\_abcd]/', RegExpState.Invalid],
        ['[\\_abcd]/', RegExpState.Invalid],
        ['[\\\`]/', RegExpState.Invalid],
        ['(?=/', RegExpState.Invalid],
        ['[abc\\_abcd', RegExpState.Invalid],
        ['[\\u{10ffff}]/', RegExpState.ValidAsUnicode],
        ['\\2(x)/', RegExpState.Invalid],
        ['[9-1]/', RegExpState.Invalid],
        ['[\\x01-\\u{347}]/', RegExpState.Invalid],
        ['[\\u{5}-1]/', RegExpState.ValidAsUnicode],
        ['[x---]/', RegExpState.Invalid],
        ['[0---]/', RegExpState.Invalid],
        ['[x-\\uD83D\\uDE07--+]/', RegExpState.Invalid],
        ['[x-\\uD83D\\uDE07--x-\\uD83D\\uDE07--]/', RegExpState.Invalid],
        ['(', RegExpState.Invalid],
        [')/', RegExpState.UnmatchedRightParen],
        ['(?x)/', RegExpState.Invalid],
        ['(?', RegExpState.Invalid],
        ['(?:b)/', RegExpState.Valid],
        ['a(?:b)/', RegExpState.Valid],
        ['[a-dc-b]/', RegExpState.Invalid],
        ['[b-ac-e]/', RegExpState.Invalid],
        ['[\\db-G]/', RegExpState.Invalid],
        ['[\\Db-G]/', RegExpState.Invalid],
        ['[\\Sb-G]/', RegExpState.Invalid],
        ['[\\wb-G]/', RegExpState.Invalid],
        ['[\\Wb-G]/', RegExpState.Invalid],
        ['[\\0b-G]/', RegExpState.Invalid],
        ['[\\nd-G]/', RegExpState.Invalid],
        ['[\\vd-G]/', RegExpState.Invalid],
        ['[\\fd-G]/', RegExpState.Invalid],
        ['b-G\\0]/', RegExpState.Valid],
        ['[b-G\\10]/', RegExpState.Invalid],
        ['[d-G\\b]/', RegExpState.Invalid],
        ['[d-G\\B]/', RegExpState.Invalid],
        ['[d-G\\t]/', RegExpState.Invalid],
        ['[d-G\\n]/', RegExpState.Invalid],
        ['[d-G\\t]/', RegExpState.Invalid],
        ['[\\u0061d-G]/', RegExpState.Invalid],
        ['[\\Wb-G]/', RegExpState.Invalid],
        ['[d-G\\x0061]/', RegExpState.Invalid],
        ['\\\rn/', RegExpState.Invalid],
        ['[d-G\\u0061]/', RegExpState.Invalid],
        ['[d-G\\a]/', RegExpState.Invalid],
        ['[b-G\\10]/', RegExpState.Invalid],
        ['[d-G\\B]/', RegExpState.Invalid],
        ['[d-G\\t]/', RegExpState.Invalid],
        ['[b-G\\0]/', RegExpState.Invalid],
        ['[d-G\\u0061]/', RegExpState.Invalid],
        ['[b-G\\S]/', RegExpState.Invalid],
        ['[b-G\\w]/', RegExpState.Invalid],
        ['[\\vd-G]/', RegExpState.Invalid],
        ['\\b*/u', RegExpState.Invalid],
        ['\\b+/u', RegExpState.Invalid],
        ['\\b?/u', RegExpState.Invalid],
        ['\\b{1}/u', RegExpState.InvalidQuantifier],
        ['[\\"]/u', RegExpState.Invalid],
        ['[\\\`]/u', RegExpState.Invalid],
        ['[\\u{afail}]/u', RegExpState.Invalid],
        ['[\\u{fail}]/u', RegExpState.Invalid],
        ['[\\u{a]/u', RegExpState.Invalid],
        ['[\\u{af]/u', RegExpState.Invalid],
        ['[\\u{012]/u', RegExpState.Invalid],
        ['[\\u{01234]/u', RegExpState.Invalid],
        ['[\\u{103456', RegExpState.Invalid],
        ['[\\u{12345', RegExpState.Invalid],
        ['[\\u{1234', RegExpState.Invalid],
        ['[\\u{123', RegExpState.Invalid],
        ['[\\u{af', RegExpState.Invalid],
        ['[\\u{120000}]/u', RegExpState.ValidAsUnicode],
        ['[\\d-z]/u', RegExpState.ValidAsUnicode],
        ['[a-\\dx]/u', RegExpState.Invalid],
        ['[A-\\S]/u', RegExpState.Invalid],
        ['[A-\\W]/u', RegExpState.Invalid],
        ['[a-\\w]/u', RegExpState.Invalid],
        ['[A-\\S]/u', RegExpState.Invalid],
        ['[a-\\s]/u', RegExpState.Invalid],
        ['[A-\\D]/u', RegExpState.Invalid],
        ['[a-\\d]/u', RegExpState.Invalid],
        ['[a-\\wx]/u', RegExpState.Invalid],
        ['[A-\\Sx]/u', RegExpState.Invalid],
        ['[a-\\sx]/u', RegExpState.Invalid],
        ['[9-1]/u', RegExpState.Invalid],
        ['[\\u6000-\\u5000]/u', RegExpState.Invalid],
        ['(?x)/u', RegExpState.Invalid],
        ['a(?:b)c/u', RegExpState.Valid],
        ['a(?:b)/u', RegExpState.Valid],
        ['\\bot/', RegExpState.Valid],
        ['[a-z]+\\d+/', RegExpState.Valid],
        ['[a-z]+\\d+/', RegExpState.Valid],
        ['(aa)bcd\\1/', RegExpState.Valid],
        ['(aa).+\\1/', RegExpState.Valid],
        ['(\\|)([\\w\\x81-\\xff ]*)(\\|)([\\/a-z][\\w:\\/\\.]*\\.[a-z]{3,4})(\\|)/ig', RegExpState.ValidAsUnicode],
        ['q[ax-zb](?=\\s+)/', RegExpState.Valid],
        ['b{0,93}c/', RegExpState.Valid],
        ['bc..[\\d]*[\\s]*/', RegExpState.ValidAsUnicode],
        ['[\\d]*[\\s]*bc./', RegExpState.ValidAsUnicode],
        ['b{2,}c/', RegExpState.Valid],
        ['^([a-z]+)*[a-z]$/', RegExpState.Valid],
        ['^(([a-z]+)*[a-z]\\.)+[a-z]{2,}$/', RegExpState.Valid],
        ['((((((((((A))))))))))\\10\\9\\8\\7\\6\\5\\4\\3\\2\\1/', RegExpState.Valid],
        ['[]a/', RegExpState.Valid],
        ['[^]a/m', RegExpState.Valid],
        ['a[^]/', RegExpState.Valid],
        ['1?1/mig', RegExpState.Valid],
        ['[^\\[\\b\\]]+/', RegExpState.ValidAsUnicode],
        ['\\u0042/i', RegExpState.Valid],
        ['.[\\b]./', RegExpState.Valid],
        ['[^a-z]{4}/', RegExpState.Valid],
        ['a[^b]c/', RegExpState.Valid],
        ['a[^1-9]c/', RegExpState.Valid],



        ['<body.*>((.*\\n?)*?)<\\/body>/i', RegExpState.Valid],
        ['(\\|)([\\w\\x81-\\xff ]*)(\\|)([\\/a-z][\\w:\\/\\.]*\\.[a-z]{3,4})(\\|)/ig', RegExpState.ValidAsUnicode],
        ['([\\S]+([ \\t]+[\\S]+)*)[ \\t]*=[ \\t]*[\\S]+/', RegExpState.ValidAsUnicode],
        ['^(([a-z]+)*([a-z])\\.)+[a-z]{2,}$/', RegExpState.Valid],
        ['[1234567].{2}/', RegExpState.Valid],
        ['a[^b]c/', RegExpState.Valid],
        ['.*a.*/', RegExpState.Valid],
        ['[a-z]+\\d+/', RegExpState.Valid],
        ['(aa)bcd\\1/', RegExpState.Valid],
        ['(a)?a/', RegExpState.Valid],
        ['^(A)?(A.*)$/', RegExpState.Valid],
        ['a|(b)/', RegExpState.Valid],
        ['(a)?(a)/', RegExpState.Valid],
        ['^([a-z]+)*[a-z]$/', RegExpState.Valid],
        ['.+/', RegExpState.Valid],
        ['.*a.*/', RegExpState.Valid],
        ['[a-z]+/', RegExpState.Valid],
        ['\\b(\\w+) \\1\\b/', RegExpState.Valid],
        ['([xu]\\d{2}([A-H]{2})?)\\1/', RegExpState.Valid],
        ['([xu]\\d{2}([A-H]{2})?)\\1/', RegExpState.Valid],
        ['(123){1,}x\\1/', RegExpState.Valid],
        ['(\\.(?!com|org)|\\/)/', RegExpState.Valid],
        ['(?!a|b)|c/', RegExpState.Valid],
        ['(?=(a+))/', RegExpState.Valid],
        ['o+/', RegExpState.Valid],
        ['Java(?!Script)([A-Z]\\w*)/', RegExpState.Valid],
        ['b{2,}c/', RegExpState.Valid],
        ['^.*?(:|$)/', RegExpState.Valid],
        ['^.*(:|$)/', RegExpState.Valid],
        ['b{2,3}c/', RegExpState.Valid],
        ['^.*?$/', RegExpState.Valid],
        ['\\B\\B\\B\\B\\B\\Bbot\\b\\b\\b\\b\\b\\b\\b/', RegExpState.Valid],
        ['\\w{3}\\d?/', RegExpState.Valid],
        ['^\\^+/', RegExpState.Valid],
        ['xyz|.../', RegExpState.Valid],
        ['(.)..|abc/', RegExpState.Valid],
        ['.+: gr(a|e)y/', RegExpState.Valid],
        ['(a)|(b)|(c)|(d)/', RegExpState.Valid],
        ['()|/', RegExpState.Valid],
        //  ['\\%([0-9]*)\\[(\\^)?(\\]?[^\\]]*)\\]/', RegExpState.Valid], // Note! Should pass
        ['\\%([0-9]*)\\[(\\^)?\\]/', RegExpState.GoodSansUFlag],
        ['(\\]?[^\\]]*)\\]/', RegExpState.ValidAsUnicode],
        ['(?=.){1}/', RegExpState.Valid],
        ['(?!.){1}/', RegExpState.Valid],
        ['(?!.)?/', RegExpState.Valid],
        ['(?!.)+/', RegExpState.Valid],
        ['(?!.)*/', RegExpState.Valid],
        ['a(?!b(c)d)e/', RegExpState.Valid],
        ['a(?!b(?:c)d)e/', RegExpState.Valid],
        ['a(?!b(?=c)d)e/', RegExpState.Valid],
        ['a(?!b(?!c)d)e/', RegExpState.Valid],
        ['a(b(c)d)e/', RegExpState.Valid],
        ['a(b(?:c)d)e/', RegExpState.Valid],
        ['a(b(?=c)d)e/', RegExpState.Valid],
        ['a(b(?!c)d)e/', RegExpState.Valid],
        ['a(?:b(c)d)e/', RegExpState.Valid],
        ['a(?:b(?:c)d)e/', RegExpState.Valid],
        ['a(?:b(?=c)d)e/', RegExpState.Valid],
        ['a(?:b(?!c)d)e/', RegExpState.Valid],

        ['(?:(?:b))/', RegExpState.Valid],
        ['(?:a(?:b))/', RegExpState.Valid],
        ['a(?:a(?:b)c)c/', RegExpState.Valid],
        ['(?:a(?:b)c)c/', RegExpState.Valid],
        ['a(?:(?:b)c)c/', RegExpState.Valid],
        ['(?:(?:b)c)c/', RegExpState.Valid],
        ['a(?:(?:b)c)/', RegExpState.Valid],
        ['(?:(?:b)c)/', RegExpState.Valid],
        ['a(?:a(?:b))c/', RegExpState.Valid],

        ['a(?:a(?:b))/', RegExpState.Valid],
        //        ['a(?:b)c', RegExpState.Valid],
        ['a(?:b)c/', RegExpState.Valid],
        ['a((b)c)c/', RegExpState.Valid],

        ['a((b)c)c/', RegExpState.Valid],
        ['a((b)c)c/', RegExpState.Valid],
        ['a((b)c)c/', RegExpState.Valid],
        ['a((b)c)c/', RegExpState.Valid],

        ['a((b)c)/', RegExpState.Valid],
        ['((b)c)/', RegExpState.Valid],
        ['a(a(b))c/', RegExpState.Valid],
        ['(a(b))c/', RegExpState.Valid],
        ['a(a(b))/', RegExpState.Valid],
        ['[\\uD83D\\uDCA9]/', RegExpState.ValidAsUnicode],

        ['[A-Z\\Dx]/', RegExpState.ValidAsUnicode],
        ['[a-z\\s]/', RegExpState.ValidAsUnicode],
        ['[A-S\\Sx]/', RegExpState.ValidAsUnicode],

        ['[x\\udebc\\udebcy]/i', RegExpState.ValidAsUnicode],
        ['[x\\udebcy]/g', RegExpState.ValidAsUnicode],
        ['[\\ud900y]/', RegExpState.Valid],


        ['(?=.)*/', RegExpState.Valid],
        ['(?=.)+/', RegExpState.Valid],
        ['(?=.)?/', RegExpState.Valid],
        ['(?=.){1}/', RegExpState.Valid],
        ['\\b*/u', RegExpState.Invalid],
        ['\\b?/u', RegExpState.Invalid],
        ['\\B{1}/u', RegExpState.InvalidQuantifier],
        ['\\B++/u', RegExpState.Invalid],
        ['\\B?+/u', RegExpState.Invalid],
        ['(?!.)**/u', RegExpState.Invalid],
        ['(?!.)++/u', RegExpState.Invalid],
        ['(?=.)++/u', RegExpState.Invalid],
        ['?!.){1}+/u', RegExpState.Invalid],
        ['(?=.){1}+/u', RegExpState.Invalid],
        ['(?=.)?+/u', RegExpState.Invalid],
        ['?=.)**/u', RegExpState.Invalid],
        ['(?!b)', RegExpState.Invalid],
        ['a(?=b(?:cd)e/u', RegExpState.Invalid],
        ['a(?=b(?:cde/u', RegExpState.Invalid],
        ['a(?=b(?=cd)e/u', RegExpState.Invalid],
        ['a(?!b(c)de/u', RegExpState.Invalid],
        ['a(?!b(cde/u', RegExpState.Invalid],
        ['a(?!b(?:cde/u', RegExpState.Invalid],
        ['a(?!b(?=cd)e/u', RegExpState.Invalid],
        ['a(?!b(?=cde/u', RegExpState.Invalid],
        ['a(?!b(?!cd)e/u', RegExpState.Invalid],
        ['a(?!b(?!cde/u', RegExpState.Invalid],
        ['+a/u', RegExpState.Invalid],
        ['a(?=b(?:cd)e/', RegExpState.Invalid],
        ['a(?=b(?:cde/', RegExpState.Invalid],
        ['a(?=b(?=cd)e/', RegExpState.Invalid],
        ['a(?=b(?=cde/', RegExpState.Invalid],
        ['a(?=b(?!cd)e/', RegExpState.Invalid],
        ['a(?=b(?!cde/', RegExpState.Invalid],
        ['a(?!b(c)de/', RegExpState.Invalid],
        ['a(?!b(cde/', RegExpState.Invalid],
        ['a(?!b(?:cd)e/', RegExpState.Invalid],
        ['a(?!b(?:cde/', RegExpState.Invalid],
        ['a(?!b(?=cd)e/', RegExpState.Invalid],
        ['a(?!b(?=cde/', RegExpState.Invalid],
        ['a(?!b(?!cd)e/', RegExpState.Invalid],
        ['a(?!b(?!cde/', RegExpState.Invalid],
        ['a(bcde/', RegExpState.Invalid],
        ['(b(?=cd)e/', RegExpState.Invalid],
        ['(b(?=cde/', RegExpState.Invalid],
        ['(b(?!cd)e/', RegExpState.Invalid],
        ['(b(?!cde/', RegExpState.Invalid],
        ['(?:b(cd)e/', RegExpState.Invalid],
        ['(?:b(cde/', RegExpState.Invalid],
        ['(?:b(?:cd)e/', RegExpState.Invalid],
        ['(?:b(?:cde/', RegExpState.Invalid],
        ['a(?:b(?=cd)e/', RegExpState.Invalid],
        ['a(?:b(?=cde/', RegExpState.Invalid],
        ['(?:b(?!cde/', RegExpState.Invalid],
        ['(?=b(cd)e/', RegExpState.Invalid],
        ['[b-ac-e]/u', RegExpState.Invalid],
        ['[a-dc-b]/u', RegExpState.Invalid],
        ['[\\db-G]/u', RegExpState.Invalid],
        ['[\\c0001d-G]/u', RegExpState.Invalid],
        ['[d-G\\b]/u', RegExpState.Invalid],
        ['\\B+/u', RegExpState.Invalid],
        ['\\b?/u', RegExpState.Invalid],
        ['\\7/u', RegExpState.Invalid],

        ['[abc\\_', RegExpState.Invalid],
        ['[\\_abcd', RegExpState.Invalid],
        ['[abc\\_abcd', RegExpState.Invalid],
        ['[abc\\$abcd', RegExpState.Invalid],
        ['[\\x8]/', RegExpState.Invalid],
        ['[\\x7]/', RegExpState.Invalid],
        ['[\\x]/', RegExpState.Invalid],
        ['[\\x6]/', RegExpState.Invalid],
        ['[abc\\Ydeff]/', RegExpState.Invalid],
        ['[abc\\Zdeff]/', RegExpState.Invalid],
        ['[abc\\Vdeff]/', RegExpState.Invalid],
        ['[abc\\Rdeff]/', RegExpState.Invalid],
        ['[abc\\Qdeff]/', RegExpState.Invalid],
        ['[abc\\Pdeff]/', RegExpState.Invalid],
        ['[abc\\ldeff]/', RegExpState.Invalid],
        ['[\\Kabcd]/', RegExpState.Invalid],
        ['[\\Iabcd]/', RegExpState.Invalid],
        ['[\\kabcd]/', RegExpState.Invalid],

        ['[abc\\Edeff]/', RegExpState.Invalid],
        ['[abc\\Fdeff]/', RegExpState.Invalid],
        ['[abc\\Gdeff]/', RegExpState.Invalid],
        ['[abc\\kdeff]/', RegExpState.Invalid],
        ['[abc\\hdeff]/', RegExpState.Invalid],
        ['[\\eabcd]/', RegExpState.Invalid],
        ['[\\aabcd]/', RegExpState.Invalid],
        ['[\\Aabcd]/', RegExpState.Invalid],
        ['[\\_]/', RegExpState.Invalid],
        ['[abc\\_]/', RegExpState.Invalid],
        ['[\\_abcd]/', RegExpState.Invalid],
        ['[abc\\_abcd]/', RegExpState.Invalid],

        ['[\\.', RegExpState.Invalid],
        ['[\\r]/', RegExpState.ValidAsUnicode],
        ['[\\s]/', RegExpState.ValidAsUnicode],
        ['[\\S]/', RegExpState.ValidAsUnicode],
        ['[\\t]/', RegExpState.ValidAsUnicode],
        ['[\\v]/', RegExpState.ValidAsUnicode],
        ['[\\w]/', RegExpState.ValidAsUnicode],
        ['[\\W]/', RegExpState.ValidAsUnicode],
        ['[F]/', RegExpState.Valid],
        ['[G]/', RegExpState.Valid],
        ['[I]/', RegExpState.Valid],


        ['\\u{1}/', RegExpState.ValidAsUnicode],
        ['\\u{12}/', RegExpState.ValidAsUnicode],
        ['\\u{123}/', RegExpState.ValidAsUnicode],

        ['\\u{1234}/', RegExpState.ValidAsUnicode],
        ['\\u{12345}/', RegExpState.ValidAsUnicode],
        ['\\u{01234/', RegExpState.Invalid],
        ['\\u{012345/', RegExpState.Invalid],

        ['\\u{xxxx}/', RegExpState.InvalidQuantifier],
        ['\\u{0fail}/', RegExpState.InvalidQuantifier],
        ['\\u{afail}/', RegExpState.InvalidQuantifier],

        ['\\u{fail}/', RegExpState.InvalidQuantifier],
        ['\\u{}/', RegExpState.InvalidQuantifier],
        ['\\u{012345}\\u{6789a}/', RegExpState.ValidAsUnicode],

        ['\\u{012345} postfix/', RegExpState.ValidAsUnicode],
        ['prefix \\u{012345}/', RegExpState.ValidAsUnicode],
        ['\\u{89abc}/', RegExpState.ValidAsUnicode],
        ['\\u{defAB}/', RegExpState.ValidAsUnicode],
        ['x\\udebc\\udebcy/', RegExpState.Valid],
        ['\\udd00\\udd00y/', RegExpState.Valid],
        ['x\\ud810\\udc10/', RegExpState.Valid],
        ['\\ud800\\udc00/', RegExpState.Valid],
        ['\\udc00\\udc00/', RegExpState.Valid],
        ['\\ud900\\ud900y/', RegExpState.Valid],
        ['x\\ud810\\ud810/', RegExpState.Valid],
        ['x\\udabcy/', RegExpState.Valid],

        ['\\u1234/', RegExpState.Valid],
        ['((((((((((((((((((((a))))))))))))))))))))\\21/', RegExpState.Invalid],
        ['((a))\\3/', RegExpState.Invalid],
        ['((((((a))))))\\7/', RegExpState.Invalid],
        ['(((((((a)))))))\\8/', RegExpState.Invalid],
        ['(((((((((((a)))))))))))\\12/', RegExpState.Invalid],
        ['((((((((((((((((a))))))))))))))))\\17/', RegExpState.Invalid],
        ['\\cf', RegExpState.Invalid],
        ['\\cG/', RegExpState.Valid],
        ['\\cg/', RegExpState.Valid],

        ['\\cw/', RegExpState.Valid],
        ['\\cZ/', RegExpState.Valid],
        ['\\cW/', RegExpState.Valid],
        ['\\cV/', RegExpState.Valid],
        ['\\cT/', RegExpState.Valid],
        ['\\cS/', RegExpState.Valid],
        ['\\cQ/', RegExpState.Valid],
        ['\\cR/', RegExpState.Valid],
        ['\\cS/', RegExpState.Valid],
        ['\\cq/', RegExpState.Valid],
        ['\\cr/', RegExpState.Valid],
        ['\\cs/', RegExpState.Valid],
        ['\\ct/', RegExpState.Valid],
        ['abc\\r', RegExpState.Invalid],
        ['abc\\t', RegExpState.Invalid],
        ['abc\\ydeff/', RegExpState.Invalid],
        ['abc\\zdeff/', RegExpState.Invalid],
        ['\\Qabcd/', RegExpState.Invalid],
        ['\\Oabcd/', RegExpState.Invalid],
        ['\\Uabcd/', RegExpState.Invalid],
        ['\\Vabcd/', RegExpState.Invalid],
        ['\\Yabcd/', RegExpState.Invalid],
        ['\\Y/', RegExpState.Invalid],
        ['\\Z/', RegExpState.Invalid],
        ['abc\\U/', RegExpState.Invalid],
        ['\\Vabcd/', RegExpState.Invalid],
        ['\\Yabcd/', RegExpState.Invalid],
        ['\\Y/', RegExpState.Invalid],
        ['\\Z/', RegExpState.Invalid],
        ['abc\\U/', RegExpState.Invalid],
        ['abc\\u/', RegExpState.Invalid],
        ['abc\\Z/', RegExpState.Invalid],
        ['abc\\mdeff/', RegExpState.Invalid],
        ['\\oabcd/', RegExpState.Invalid],
        ['abc\\Ldeff/', RegExpState.Invalid],
        ['abc\\y/', RegExpState.Invalid],
        ['a|', RegExpState.Invalid],
        ['|', RegExpState.Invalid],
        ['abc\\tdeff', RegExpState.Invalid],
        ['abc\\wdeff/', RegExpState.Valid],
        ['abc\\tdeff/', RegExpState.Valid],
        ['abc\\vdeff/', RegExpState.Valid],
        ['abc\\Wdeff/', RegExpState.Valid],
        ['\\Wabcd/', RegExpState.Valid],
        ['abc\\vdeff/', RegExpState.Valid],
        ['abc\\wdeff/', RegExpState.Valid],
        ['abc\\Wdeff/', RegExpState.Valid],
        ['\\u00c5/ui', RegExpState.Valid],
        ['\\u212b/ui', RegExpState.Valid],
        ['\\ud801\\udc00/ui', RegExpState.Valid],
        ['\\u1f8d/', RegExpState.Valid],
        ['(.)\\1\\1/', RegExpState.Valid],
        ['(.)\\1/ui', RegExpState.Valid],
        ['\\u00e5\\u00e5\\u00e5/ui', RegExpState.Valid],
        ['AB\\u{10400}/ui', RegExpState.ValidAsUnicode],
        ['(.)\\1/ui', RegExpState.Valid],
        ['\\u{12345}{3}/u', RegExpState.ValidAsUnicode],
        ['\\ud808\\udf45{3}/u', RegExpState.Valid],
        ['\\u{12345}{3}/u', RegExpState.ValidAsUnicode],
        ['(.)\\1/ui', RegExpState.Valid],
        ['(.)\\1/ui', RegExpState.Valid],
        ['[\\u{62}-\\u{00000066}]oo/u', RegExpState.ValidAsUnicode],
        ['[\\u{62}-\\u{00000066}]oo/u', RegExpState.ValidAsUnicode],
        ['[\\u0062-\\u0066]oo/', RegExpState.Invalid],
        ['\\\\8/u', RegExpState.Valid],
        ['\\u{12345}/u', RegExpState.ValidAsUnicode],
        ['\\u{12345}\\u{23456}/u', RegExpState.ValidAsUnicode],
        ['\\u{12345}(?:\\u{23456})/u', RegExpState.ValidAsUnicode],
        ['\\u{12345}|\\u{23456}/u', RegExpState.ValidAsUnicode],
        ['(\\u{12345}|\\u{23456}).\\1/u', RegExpState.ValidAsUnicode],
        ['\\u{12345}{3}/u', RegExpState.ValidAsUnicode],
        ['\\u{12345}|\\u{23456}/u', RegExpState.ValidAsUnicode],
        ['\\u{12345}(?:\\u{23456})/u', RegExpState.ValidAsUnicode],
        ['\\u{12345}/u', RegExpState.ValidAsUnicode],
        ['\\u{12345}{3}/u', RegExpState.ValidAsUnicode],
        ['\\ud808\\udf45{3}/u', RegExpState.Valid],
        ['\\u{12345}{3}/u', RegExpState.ValidAsUnicode],
        ['(?=.)*/u', RegExpState.Valid],
        ['\\09/u', RegExpState.Invalid],
        ['[\\c]/u', RegExpState.Invalid],
        ['[\\c0]/u', RegExpState.Invalid],
        ['a{/u', RegExpState.NothingToRepeat],
        ['a{1,/u', RegExpState.NothingToRepeat],
        ['{/u', RegExpState.NothingToRepeat],
        ['}/u', RegExpState.InvalidQuantifier],
        [']/u', RegExpState.Valid],
        ['\\1/u', RegExpState.Invalid],
        ['[\\w-a]/u', RegExpState.ValidAsUnicode],
        ['[a-\\w]/u', RegExpState.Invalid],
        ['\\u00c5/ui', RegExpState.Valid],
        ['\\u212b/', RegExpState.Valid],
        ['\\u{10400}/', RegExpState.ValidAsUnicode],
        ['\\u00df/ui', RegExpState.Valid],
        ['\\u1f8d/ui', RegExpState.Valid],
        ['\\u00e5\\u212b\\u00c5/', RegExpState.Valid],
        ['AB\\u{10400}/ui', RegExpState.ValidAsUnicode],
        ['[\\uff40-\\u{10428}]+/ui', RegExpState.ValidAsUnicode],
        ['[\\d-x]+/', RegExpState.ValidAsUnicode],
        ['[x\-\\d]+/', RegExpState.Invalid],
        ['[\\d-]+/', RegExpState.ValidAsUnicode],
        ['[\\d-x]+/', RegExpState.ValidAsUnicode],
        ['[a-c]+/', RegExpState.Valid],
        ['[c-a]+/', RegExpState.Invalid],
        ['[\\d-x]+/', RegExpState.ValidAsUnicode],
        ['[a-c]+/', RegExpState.Valid],
        ['[x\-\\d]+/', RegExpState.Invalid],
        ['(?=a){0}/', RegExpState.Valid],
        ['(?=a){1}/', RegExpState.Valid],
        ['(?!a){0}/', RegExpState.Valid],
        ['(?!a){1}/', RegExpState.Valid],
        ['\\n$/', RegExpState.Valid],
        ['a\z/', RegExpState.Valid],
        ['\_/', RegExpState.Valid],
        ['./', RegExpState.Valid],
        ['a./', RegExpState.Valid],
        ['a*/', RegExpState.Valid],
        ['a?/', RegExpState.Valid],
        [')/', RegExpState.UnmatchedRightParen],
        ['a)/', RegExpState.UnmatchedRightParen],
        ['[/', RegExpState.Invalid],
        ['a[/', RegExpState.Invalid],
        ['a[b-a]/', RegExpState.Invalid],
        ['[b-a]/', RegExpState.Invalid],
        ['{0}/', RegExpState.InvalidQuantifier],
        ['{1,0}/', RegExpState.InvalidQuantifier],
        ['a{1,0}/', RegExpState.NothingToRepeat],
        ['a}/', RegExpState.InvalidQuantifier],
        ['[^\\u1234-\\u{12345}]/u', RegExpState.ValidAsUnicode],
        ['\\u{1233}/', RegExpState.ValidAsUnicode],
        ['[\\ud808\\udf40-\\ud808\\udf45]/', RegExpState.ValidAsUnicode],
        ['a??/', RegExpState.Valid],
        ['a||/', RegExpState.Valid],
        ['|/', RegExpState.Valid],
        ['a|/', RegExpState.Valid],
        ['|a/', RegExpState.Valid],
        ['a|b/', RegExpState.Valid],
        ['abc/', RegExpState.Valid],
        ['\\tabcd/', RegExpState.Valid],
        ['\\Sabcd/', RegExpState.Valid],
        ['abc\\p/', RegExpState.Invalid],
        ['abc\\q/', RegExpState.Invalid],
        ['\\T/', RegExpState.Invalid],
        ['abc\\pdeff/', RegExpState.Invalid],
        ['abc\\Jdeff/', RegExpState.Invalid],
        [`\\'/`, RegExpState.GoodSansUFlag],
        [`\\"/`, RegExpState.GoodSansUFlag],
        ['$/', RegExpState.Valid],
        ['abc\\v/', RegExpState.Valid],
        ['abc\\w/', RegExpState.Valid],
        ['abc\\W/', RegExpState.Valid],
        ['foo/gmi', RegExpState.Valid],
        ['foo/mi', RegExpState.Valid],
        ['a{9,94}/', RegExpState.Valid],
        ['a{6,61}/', RegExpState.Valid],
        ['a{5,50}/', RegExpState.Valid],
        ['a{2,27}/', RegExpState.Valid],
        ['a{0,15}/', RegExpState.Valid],
        ['a{,38}/', RegExpState.Valid],
        ['a{,49}/', RegExpState.Valid],
        ['a{,72}/', RegExpState.Valid],
        ['a{,83}/', RegExpState.Valid],
        ['a{9,9}/', RegExpState.Valid],
        ['a{0,}/', RegExpState.Valid],
        ['a{9,}/', RegExpState.Valid],
        ['a{2,}/', RegExpState.Valid],
        ['a{67}/', RegExpState.Valid],
        ['a{34}/', RegExpState.Valid],
        ['a{11}/', RegExpState.Valid],
        ['a{4}/', RegExpState.Valid],
        ['a{2}/', RegExpState.Valid],
        ['a{0}/', RegExpState.Valid],
        ['a{0,0}/', RegExpState.Valid],
        ['a{90,9}/', RegExpState.NothingToRepeat],
        ['a{67,6}/', RegExpState.NothingToRepeat],
        ['a{45,4}/', RegExpState.NothingToRepeat],
        ['a{12,1}/', RegExpState.NothingToRepeat],
        ['a{1,0}/', RegExpState.NothingToRepeat],
        ['a{01,1}/', RegExpState.NothingToRepeat],
        ['a{0x15,02}/', RegExpState.InvalidQuantifier],
        ['a{0x01,1}/', RegExpState.InvalidQuantifier],
        ['a{00,0o01}/', RegExpState.InvalidQuantifier],
        ['a{ 1 , 1 }/', RegExpState.InvalidQuantifier],
        ['a{1,1 }/', RegExpState.InvalidQuantifier],
        ['a{ 1, 1}/', RegExpState.InvalidQuantifier],
        ['a{1, 1}/', RegExpState.InvalidQuantifier],
        ['a{ 1}/', RegExpState.InvalidQuantifier],
        ['\\cu/', RegExpState.Valid],
        ['\\cv/', RegExpState.Valid],
        ['\\cx/', RegExpState.Valid],
        ['\\cy/', RegExpState.Valid],
        ['\\cz/', RegExpState.Valid],
        ['\\x4e/', RegExpState.Valid],
        ['\\x3d/', RegExpState.Valid],
        ['\\x23/', RegExpState.Valid],
        ['\\xCD/', RegExpState.Valid],
        ['\\xEF/', RegExpState.Valid],
        ['\\x6A/', RegExpState.Valid],
        ['\\x5f/', RegExpState.Valid],
        ['\\xc3/', RegExpState.Valid],
        ['\\x12/', RegExpState.Valid],
        ['\\x90/', RegExpState.Valid],
        ['\\x23/', RegExpState.Valid],
        ['\\x89/', RegExpState.Valid],
        ['/a\\0b/', RegExpState.Valid],
        ['(a)\\0/', RegExpState.Valid],
        ['(1\\0)/', RegExpState.Valid],
        ['\\0/', RegExpState.Valid],
        ['\\0b/', RegExpState.Valid],
        ['a\\0/', RegExpState.Valid],
        ['(a|\\1)/', RegExpState.Valid],
        ['\\1|(a)/', RegExpState.Valid],
        ['4\\1(a)/', RegExpState.Valid],
        ['\\1x(a)/', RegExpState.Valid],
        ['(a)\\1/', RegExpState.Valid],
        ['\\x89/', RegExpState.Valid],
        ['\\x9/', RegExpState.Invalid],
        ['\\x5/', RegExpState.Invalid],
        ['\\x6/', RegExpState.Invalid],
        ['\\x8/', RegExpState.Invalid],
        ['\\x67', RegExpState.Invalid],
        ['\\x90', RegExpState.Invalid],
        ['\\x0', RegExpState.Invalid],
        ['\\x5/', RegExpState.Invalid],
        ['\\x90', RegExpState.Invalid],
        ['\\x9', RegExpState.Invalid],
        ['\\x01', RegExpState.Invalid],
        ['\\x', RegExpState.Invalid],
        ['\\11|(a)/', RegExpState.Invalid],
        ['\\08/', RegExpState.Invalid],
        ['\\00/', RegExpState.Invalid],
        ['\\06(b)/', RegExpState.Invalid],
        ['(a)\\05/', RegExpState.Invalid],
        ['4\\1(a)', RegExpState.Invalid],
        ['\\1|a)', RegExpState.Invalid],
        ['(a)\\3/', RegExpState.Invalid],
        ['\\1x(a)', RegExpState.Invalid],
        ['\\2(a)/', RegExpState.Invalid],
        ['(a)x\\1', RegExpState.Invalid],
        ['(a\\1b)', RegExpState.Invalid],
        ['0\\1(a)', RegExpState.Invalid],
        ['4\\1(a)', RegExpState.Invalid],
        ['a\\04b/', RegExpState.Invalid],
        ['(\\07)/', RegExpState.Invalid],
        ['(\\0)/', RegExpState.Valid],
        ['(1\\0)/', RegExpState.Valid],
        ['a\\0b/', RegExpState.Valid],
        ['\\0/', RegExpState.Valid],
        ['(a)\\1/', RegExpState.Valid],
        ['((a))\\2/', RegExpState.Valid],
        ['(((((a)))))\\4/', RegExpState.Valid],
        ['((((((((((((((((((a))))))))))))))))))\\17/', RegExpState.Valid],
        ['(((((((((((((((a)))))))))))))))\\14/', RegExpState.Valid],
        ['((((((((((((((((((((a))))))))))))))))))))\\20/', RegExpState.Valid],
        ['((((((((((a))))))))))\\10/', RegExpState.Valid],
        ['x\\u0567/', RegExpState.Valid],
        ['\\uf89ay/', RegExpState.Valid],
        ['x\\ubcdey/', RegExpState.Valid],
        ['\\u1234\\u1234\\udc00/', RegExpState.Valid],
        ['x\\u0567\\u0567\\udc10/', RegExpState.Valid],
        ['(?=)/', RegExpState.Valid],
        ['[]b/', RegExpState.Valid],
        ['a[]b/', RegExpState.Valid],
        ['a[]/', RegExpState.Valid],
        ['[]/', RegExpState.Valid],
        ['[Y]/', RegExpState.Valid],
        ['[x]/', RegExpState.Valid],
        ['[y]/', RegExpState.Valid],
        ['[Z]/', RegExpState.Valid],
        ['[K]/', RegExpState.Valid],
        ['[k]/', RegExpState.Valid],
        ['[g]/', RegExpState.Valid],
        ['(?=)/', RegExpState.Valid],
        ['[\\bc]/', RegExpState.Valid],
        ['[0\\0b]/', RegExpState.Valid],
        ['[\\0b]/', RegExpState.Valid],
        ['[a\\0]/', RegExpState.Valid],
        ['[\\0]/', RegExpState.Valid],
        ['[\\s]/', RegExpState.ValidAsUnicode],
        ['[\\n]/', RegExpState.ValidAsUnicode],
        ['[\\d]/', RegExpState.ValidAsUnicode],
        ['||||/', RegExpState.Valid],
        ['||||/', RegExpState.Valid],
        ['(?!)/', RegExpState.Valid],
        ['(?=)/', RegExpState.Valid],
        ['||||/', RegExpState.Valid],
    ]

    for (const [regExp, state] of regExs) {
        it(`scans '${regExp}'`, () => {
            const parser = createParserObject(regExp, undefined);
            const found = scanRegExp(parser, Context.Empty);
            t.deepEqual({
                token: found,
            }, {
                token: state,
            });
        });
    }
});